function dx = threebody(t,x)

G=6.67259e-11;
M=5.974e24;
m=7.348e22;
miustar=M/(m+M);
miu=m/(m+M);
D=3.844e8;
d=4.669e6;
r1=@(x,y) sqrt((x+d).^2+y.^2);
r2=@(x,y) sqrt((D-d-x).^2+y.^2);
omega=2.661e-6;

dx = zeros(4,1);    % a column vector
dx(1) = x(2);
dx(2) = -G*(M*(x(1)+miu*D)./(r1(x(1),x(3)).^3)+...
    m*(x(1)-miustar*D)./(r2(x(1),x(3)).^3))+omega^2*x(1)+2*omega*x(4);
dx(3) = x(4)
dx(4) = -G*(M*x(3)./(r1(x(1),x(3)).^3)+m*x(3)./(