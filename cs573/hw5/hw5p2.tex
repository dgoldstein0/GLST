\documentclass[a4paper,12pt]{article}
\begin{document}
Yongzuan Wu

wu68

cs573

HW 5

Problem 2

reference: http://www.cs.princeton.edu/~wayne/cs423/lectures/max-flow-applications-4up.pdf

We reduce the problem to a maximum flow problem with edge demand. First we calculate the sum of each original rows and columns, call them $rowsum[1..m]$ and $colsum[1..n]$. We use a vertex to represent each row and column, and edge between row $i$ and column $j$ represent the number $A[i][j]$. Formally,

let $G=(R\cup C\cup \{s,t\},E,c,d)$ be a flow network with edge demand, where $R=\{r_{1},r_{2},...,r_{m}\}$, $C=\{c_{1},c_{2},...,c_{n}\}$, 

$$
c(u\rightarrow v) = \left\{ \begin{array}{rl}
  rowsum[i] &\mbox{ if $u=s$ and $v=r_{i}$} \\
  colsum[i] &\mbox{ if $u=c_{i}$ and $v=t$} \\
  \left\lceil A[i][j]\right\rceil    &\mbox{ if $u=r_{i}$ and $v=c_{j}$} \\
  0 &\mbox{ otherwise}
       \end{array} \right.      
$$ 

$$
d(u\rightarrow v) = \left\{ \begin{array}{rl}
  \left\lfloor A[i][j]\right\rfloor    &\mbox{ if $u=r_{i}$ and $v=c_{j}$} \\
  0 &\mbox{ otherwise}
       \end{array} \right.      
$$ 

A integer value of flow in this network represents an appropriate rounding of elements of the matrix. And the maximum flow of an integer capacity network is always integer. Thus the algorithm follows,

\

MatrixRounding(A[1..m][1..n])

\ construct flow network $G$ as described above

\ compute maximum flow $F$ in $G$

\ if ($F$ saturates all the edges going out of $s$ and all the edges going into $t$)

\ \ \ \ $A'[i][j]=f(r_{i},c_{j})$

\ \ \ \ return $A'$

\ else return ('No such rounding exist')

\

Analysis:
Computing the maximum flow by Dinitz algorithm with dynamic trees costs $O(VElog(V))$ time. By construction, $\left|V\right|=O(m+n)$, $\left|E\right|=O((m+n)^{2})$. The cost to construct the network and convert the edge demand problem to a normal problem is relatively small, thus obsorbed in the big O notation. Thus the running time is $O((m+n)^3log(m+n))$.



\end{document}